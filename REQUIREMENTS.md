# 要件

大量なESP32デバイスで構成するIoTシステムがありまして、以下の要件を満足するOTA機能を開発したい。

- ESP32デバイスにはArduinoをベースしたアプリケーションがあります。このアプリケーションにOTAの機能を追加します。
- ESP32デバイスは定期的に自身のMACアドレスと現行バージョン情報を使ってOTAサーバーに問い合わせし、適用可能なバージョンをダウンロードします。
- ESP32デバイスはダウンロードしたバージョンを適切なタイミングで更新します。失敗した場合はロールバックします。
- OTAサーバーはHTTPSプロトコルをサポートし、Pythonで開発します。
- OTAサーバー側に、問い合わせに来たESP32デバイスのIPと前記デバイス情報をDBで管理し、設定されたルールでデバイスにラベル付けのような機能があります。
- OTAサーバー側にパイロット更新（特定の一部のデバイスのみを更新し結果を検証）やスケージュール更新の機能があります。

上記要件を満足したプログラム一式を作ってください。動作テストの手順も説明してください。

要件に不明な点や確認が必要な点があれば質問してください。

コーディングする前に設計書をまず作ってレビューさせてください。
